<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>RPG</title>
</head>

<body>
    <form onsubmit="return false" id="form">
        <input type="text" id="playerName" placeholder="entre un nom fpd (fruit de la passion)" required> <!--Creation du nom du personage-->
        <button type='submit' onclick='Start()'>Start</button> <!--Button start-->
    </form>
    <p id="Result"></p>
    <div id="error message"></div>
    <p id="messagefight"></p>
    <p id='title'></p>                          <!--Creation des espaces de textes a utiliser pour l'innerhtml -->
    <div id="Combat">
        <p id="DisplayPlayer"></p>
        <p id="Display"></p>
        <div id="popo">

        </div>
    </div>

    <style>                     /* INITIATION DU CSS*/

        body {
            background-image: url('grass.png');     /* INITIATION DU BACKGROUD*/
        }

        #player {
            border: 10px solid brown;   /*BORDURE POUR LE PLAYER*/
        }

        #Combat {
            display: flex;
            flex-direction: row;                /*MISE EN PAGE DE LA PAGE COMBAT*/
            justify-content: space-between;
        }

        #DisplayPlayer {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: Arial, Helvetica, sans-serif;          /*MISE EN PAGE DU PLAYER*/
            font-size: 30px;
            color: brown;
            text-shadow: 2px 2px 10px black;
        }

        #Display {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: Arial, Helvetica, sans-serif;
            font-size: 30px;
            color: brown;
            text-shadow: 2px 2px 10px black;
        }

        #title {
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: Arial, Helvetica, sans-serif;      /* mise en page du titre*/
            font-size: 40px;
            color: brown;
            text-shadow: 2px 2px 10px black;
        }
        #popo{
            display: flex;
            flex-direction: row;
            justify-content: space-around;
        }
        #popo2{
            border: 10px solid brown;
        }
    </style>
    <script>                /*Initiation du js*/
        var potion;
        var force;
        var agility;
        var endurance;
        var hp;                                     /*Initiation des variables de carateristique*/
        var po;
        var Inventory = [];
        var enduranceia = 7;
        var forceia = 5;
        var hpia = enduranceia;
        var maxStrength;
        var maxAgility;
        var maxEndurance;
        const possibleIAName = ["Andre", "Thibaud", "Angamara", "François", "Romain", "Robin", "Romuald"];      /*Initiation des noms de l'ia*/
        function getRandomInt(max) {
            return Math.floor(Math.random() * Math.floor(max));     /*Creation de la fonction random*/
        }
        var iaName = possibleIAName[getRandomInt(6)];

        function DrawIA() {
            document.getElementById("DisplayPlayer").innerHTML = "<h2>" + playerName + "</h2>" + "<img id='player' src='Player.png' width='300' height='500'>";
            if (iaName == "Andre") {
                document.getElementById("Display").innerHTML = "<h2>Andre</h2>" + "<img id='player' src='Andre.png' width='300' height='500'>";
            }
            else if (iaName == "Thibaud") {
                document.getElementById("Display").innerHTML = "<h2>Thibaud</h2>" + "<img id='player' src='Thibaud.png' width='300' height='500'>";     /*Creation des sprite du personnage et de l'ia*/
            }
            else if (iaName == "Angamara") {
                document.getElementById("Display").innerHTML = "<h2>Angamara</h2>" + "<img id='player'src='Angamara.png' width='300' height='500'>";
            }
            else if (iaName == "François") {
                document.getElementById("Display").innerHTML = "<h2>François</h2>" + "<img id='player' src='François.png' width='300' height='500'>";
            }
            else if (iaName == "Romain") {
                document.getElementById("Display").innerHTML = "<h2>Romain</h2>" + "<img id='player' src='Romain.png' width='300' height='500'>";
            }
            else if (iaName == "Robin") {
                document.getElementById("Display").innerHTML = "<h2>Robin</h2>" + "<img id='player' src='Robin.png' width='300' height='500'>";
            }
            else if (iaName == "Romuald") {
                document.getElementById("Display").innerHTML = "<h1>Romuald</h1>" + "<img id='player' src='Romuald.png' width='300' height='500'>";
            }
        }
        function Start() {
            if (playerName = document.getElementById("playerName").value == "") {       /*intialisation du menu de fin de combat et du nom du hero*/

            }
            else {
                playerName = document.getElementById("playerName").value;
                Menu();
            }
            Hero();


        }
        function Menu() {
            document.getElementById("error message").innerHTML = "";
            document.getElementById("form").innerHTML = "<button type='submit' onclick='Shop()'>Shop</button>" + "<button type='submit' onclick='Fight()''>Fight</button>" +    /*Initialisation des menu principale*/
                "<button type='submit' onclick='PlayerInventory()'>Inventory</button>";
        }
        function Shop() {
            /*Initialisation des menu shop*/
            document.getElementById("error message").innerHTML = "";
            document.getElementById("form").innerHTML="";
            document.getElementById("popo").innerHTML = 
            "<div>"+
              "<img id='popo2' src='popoForce.png' width='200' height='300'>"+
              "<button type='submit' onclick='BuyPotion(\"strength\")'>Potion de Force </button>"+ 
            "</div>"+
            "<div>"+
               "<img id='popo2' src='popoAgi.png' width='200' height='300'>"+
               "<button type='submit' onclick='BuyPotion(\"agility\")'>Potion d'agilité</button>"+
            "</div>"+
            "<div>"+        
              "<img id='popo2' src='popoEndu.png' width='200' height='300'>"+
              "<button type='submit' onclick='BuyPotion(\"endurance\")'>Potion d'endurance</button>"+
            "</div>" +
            "<div>"+
              "<img id='popo2' src='PpopoVie.png' width='200' height='300'>"+
              "<button type='submit' onclick='BuyPotion(\"lifeSmall\")'>Petite potion de vie</button>" +
            "</div>"+  
            "<div>"+
              "<img id='popo2' src='GpopoVie.png' width='200' height='300'>"+
              "<button type='submit' onclick='BuyPotion(\"lifeBig\")'>Petite potion de vie</button>" +
            "</div>"+ 
                "<button type='submit' onclick='ClearBoard()'>Menu</button>";
        }
        function PlayerInventory() {
            document.getElementById("error message").innerHTML = "";
            document.getElementById("form").innerHTML = "<p>Que voulez vous utiliser?</p>" + "<button type='submit' onclick='StrengthPotion()'>Potion de Force </button>" +
                "<button type='submit' onclick='AgilityPotion()'>Potion d'agilité</button>" + "<button type='submit' onclick='EndurancePotion()'>Potion d'endurance</button>" +  /*Initialisation des menu inventaire*/
                "<button type='submit' onclick='SmallLifePotion()'>Petite potion de vie</button>" + "<button type='submit' onclick='BigLifePotion()'>Grosse potion de vie</button>" +
                "<button type='submit' onclick='Menu()'>Menu</button>";
        }
        function Hero() {
            endurance = 100;
            hp = endurance;
            force = 10;
            agility = 10;            /*Création des carateristique du hero*/
            po = 0;
            maxStrength = force;
            maxAgility = agility;
            maxEndurance = endurance;
        }
        function ResetStats() {
            hpia = enduranceia;
            endurance = maxEndurance;    /*Création de la fonction reste des carateristique*/
            agility = maxAgility;
            force = maxStrength;
        }
        function IAwin() {
            enduranceia++
            hpia = enduranceia       /*Création de la fonction des carateristique de l'ia qui augemente quand l'hero gagne*/
            forceia++
        }
        function Fight() {                   /*Création de la fonction fight*/
            DrawIA();
            let firstHit = false;
            while (hp != 0 && hpia != 0) {
                if (firstHit == false && getRandomInt(100) <= agility) {                 /*Premiere personne a attaque*/
                    firstHit = true;
                    hpia -= force;

                }
                else {
                    hpia=hpia - force;
                    if (hpia <= 0) {
                        document.getElementById("Result").innerHTML = "Victory";             /*Création de la victoire du personage*/
                        po=po+3;
                        if(getRandomInt(100)<=10){
                            Inventory.push("lifeSmall");
                        }
                        break;
                    }
                    hp = hp-forceia;
                    if (hp <=0) {
                        document.getElementById("Result").innerHTML = "Defeat";              /*Création de la defaite du personage*/
                        break;
                    }
                    

                }
            }
            ResetStats();
            document.getElementById("form").innerHTML = "<button onclick=\"ClearBoard()\">Menu</button>";
        }
        function ClearBoard() {
            Menu();
            document.getElementById("popo").innerHTML = "";
            document.getElementById("DisplayPlayer").innerHTML = "";
            document.getElementById("Display").innerHTML = "";
            document.getElementById("Result").innerHTML = "";
        }

        function StrengthPotion() {
            if (Inventory.includes("strength")) {
                force = force + 1;
                Inventory.splice(Inventory.indexOf("strength", 1));                         /*Création de la potion de force*/
            }
            else {
                document.getElementById("error message").innerHTML = "Vous n'avez pas de potion de force";
            }
        }
        function AgilityPotion() {
            if (Inventory.includes("agility")) {                                
                agile = agile + 1;                                              
                Inventory.splice(Inventory.indexOf("agility", 1));                           /*Création de la potion d'agilité*/
            }
            else {
                document.getElementById("error message").innerHTML = "Vous n'avez pas de potion d'agilité";                     
            }

        }
        function EndurancePotion() {
            if (Inventory.includes("endurance")) {
                endurance = endurance + 1;
                Inventory.splice(Inventory.indexOf("endurance", 1));                            /*Création de la potion d'endurance*/
            }
            else {
                document.getElementById("error message").innerHTML = "Vous n'avez pas de potion d'endurance";
            }
        }
        function SmallLifePotion() {
            if (Inventory.includes("lifeSmall")) {
                hp = hp + 10;
                if (hp > endurance) {
                    hp = endurance;                                         /*Création de la potion de la petite potion de vie*/
                }
                Inventory.splice(Inventory.indexOf("lifeSmall", 1));
            }
            else {
                document.getElementById("error message").innerHTML = "Vous n'avez pas de petite potion de soin";
            }
        }
        function BigLifePotion() {
            if (Inventory.includes("lifeBig")) {
                hp = hp + 20;
                if (hp > endurance) {
                    hp = endurance;
                }
                Inventory.splice(Inventory.indexOf("lifeBig", 1));                              /*Création de la potion de la grande potion de vie*/
            }
            else {
                document.getElementById("error message").innerHTML = "Vous n'avez pas de grande potion de soin";
            }
        }
        function BuyPotion(potion) {
            document.getElementById("error message").innerHTML = "";
            if (potion == "strength" && po >= 2) {
                po = po - 2;
                Inventory.push("strength");
            }
            else if (potion == "agility" && po >= 2) {
                po = po - 2;
                Inventory.push("agility");
            }
            else if (potion == "endurance" && po >= 2) {                    /*Création du shop*/
                po = po - 2;
                Inventory.push("endurance");
            }
            else if (potion == "lifeSmall" && po >= 3) {
                po = po - 3;
                Inventory.push("lifeSmall");
            }
            else if (potion == "lifeBig" && po >= 5) {
                po = po - 5;
                Inventory.push("lifeBig");
            }
            else {
                document.getElementById("error message").innerHTML = "you don't have enough money to buy this";
            }
        }
    </script>
</body>

</html>